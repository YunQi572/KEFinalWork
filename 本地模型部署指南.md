# æœ¬åœ°æ¨¡å‹éƒ¨ç½²æŒ‡å—

æ›¿ä»£ `moonshot-v1-8k-vision-preview` çš„å®Œæ•´æœ¬åœ°åŒ–éƒ¨ç½²æ–¹æ¡ˆã€‚

---

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†å®‰è£…æ­¥éª¤](#è¯¦ç»†å®‰è£…æ­¥éª¤)
- [æ¨¡å‹é€‰æ‹©](#æ¨¡å‹é€‰æ‹©)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [è‡ªå®šä¹‰æ¨¡å‹è®­ç»ƒ](#è‡ªå®šä¹‰æ¨¡å‹è®­ç»ƒ)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```powershell
# åŸºç¡€ç‰ˆæœ¬ï¼ˆCPUï¼‰
pip install -r requirements_local_model.txt

# GPU ç‰ˆæœ¬ï¼ˆæ¨èï¼Œéœ€è¦ NVIDIA GPUï¼‰
# å…ˆå¸è½½ CPU ç‰ˆæœ¬çš„ PyTorch
pip uninstall torch torchvision

# å®‰è£… CUDA 11.8 ç‰ˆæœ¬ï¼ˆæ ¹æ®ä½ çš„ CUDA ç‰ˆæœ¬é€‰æ‹©ï¼‰
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118

# æˆ– CUDA 12.1 ç‰ˆæœ¬
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
```

### 2. éªŒè¯å®‰è£…

```python
import torch
from ultralytics import YOLO

# æ£€æŸ¥ CUDA æ˜¯å¦å¯ç”¨
print(f"CUDA å¯ç”¨: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU è®¾å¤‡: {torch.cuda.get_device_name(0)}")

# æµ‹è¯• YOLO
model = YOLO('yolov8n.pt')  # é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½æ¨¡å‹
print("YOLO æ¨¡å‹åŠ è½½æˆåŠŸ!")
```

### 3. ä½¿ç”¨æœ¬åœ°æ¨¡å‹æœåŠ¡

```python
from src.local_yolo_image_service import LocalYOLOImageAnalysisService
import cv2
import asyncio

async def main():
    # åˆå§‹åŒ–æœåŠ¡
    service = LocalYOLOImageAnalysisService(model_path="yolov8m.pt")
    
    # åŠ è½½å›¾åƒ
    image = cv2.imread("test_image.jpg")
    
    # è¿›è¡Œè¯†åˆ«
    results = await service._ai_recognize_image_content(image)
    
    # è¾“å‡ºç»“æœ
    for obj in results:
        print(f"{obj['name']}: {obj['confidence']:.2f} - {obj['description']}")

asyncio.run(main())
```

---

## ğŸ“¦ è¯¦ç»†å®‰è£…æ­¥éª¤

### Windows ç³»ç»Ÿ

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Condaï¼ˆæ¨èï¼‰

```powershell
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n pine_detection python=3.10
conda activate pine_detection

# 2. å®‰è£… PyTorch (CUDA ç‰ˆæœ¬)
conda install pytorch torchvision pytorch-cuda=11.8 -c pytorch -c nvidia

# 3. å®‰è£…å…¶ä»–ä¾èµ–
pip install ultralytics opencv-python pillow numpy

# 4. éªŒè¯å®‰è£…
python -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨ pip

```powershell
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
.\venv\Scripts\Activate.ps1

# 2. å®‰è£…ä¾èµ–
pip install -r requirements_local_model.txt

# 3. å¦‚æœæœ‰ GPUï¼Œå®‰è£… CUDA ç‰ˆæœ¬
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

### Linux/Mac ç³»ç»Ÿ

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# 2. å®‰è£…ä¾èµ–
pip install -r requirements_local_model.txt

# 3. GPU ç‰ˆæœ¬ï¼ˆä»… Linux å’Œ WSL2ï¼‰
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

---

## ğŸ¯ æ¨¡å‹é€‰æ‹©

YOLOv8 æä¾›äº†ä¸åŒè§„æ¨¡çš„æ¨¡å‹ï¼š

| æ¨¡å‹         | å‚æ•°é‡ | é€Ÿåº¦  | ç²¾åº¦   | æ¨èåœºæ™¯           |
| ------------ | ------ | ----- | ------ | ------------------ |
| `yolov8n.pt` | 3.2M   | âš¡âš¡âš¡âš¡âš¡ | â­â­â­    | å¿«é€ŸåŸå‹ã€CPU è¿è¡Œ |
| `yolov8s.pt` | 11.2M  | âš¡âš¡âš¡âš¡  | â­â­â­â­   | å¹³è¡¡æ€§èƒ½           |
| `yolov8m.pt` | 25.9M  | âš¡âš¡âš¡   | â­â­â­â­â­  | **æ¨èä½¿ç”¨**       |
| `yolov8l.pt` | 43.7M  | âš¡âš¡    | â­â­â­â­â­  | é«˜ç²¾åº¦éœ€æ±‚         |
| `yolov8x.pt` | 68.2M  | âš¡     | â­â­â­â­â­â­ | æœ€é«˜ç²¾åº¦           |

### é€‰æ‹©å»ºè®®

- **å¼€å‘æµ‹è¯•**: `yolov8n.pt` (é€Ÿåº¦å¿«)
- **ç”Ÿäº§ç¯å¢ƒ**: `yolov8m.pt` (å¹³è¡¡)
- **é«˜ç²¾åº¦éœ€æ±‚**: `yolov8l.pt` æˆ– `yolov8x.pt`
- **è‡ªå®šä¹‰è®­ç»ƒ**: ä» `yolov8m.pt` å¼€å§‹

é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨ä» Ultralytics å®˜ç½‘ä¸‹è½½åˆ° `~/.cache/ultralytics/` ç›®å½•ã€‚

---

## ğŸ’» ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šæ›¿æ¢åŸæœ‰æœåŠ¡

ä¿®æ”¹ä½ çš„ä»£ç ï¼Œä» `VisionAIImageAnalysisService` åˆ‡æ¢åˆ° `LocalYOLOImageAnalysisService`:

```python
# åŸæ¥çš„ä»£ç 
# from src.vision_ai_image_service import VisionAIImageAnalysisService
# service = VisionAIImageAnalysisService()

# æ–°çš„ä»£ç 
from src.local_yolo_image_service import LocalYOLOImageAnalysisService
service = LocalYOLOImageAnalysisService(model_path="yolov8m.pt")
```

### æ–¹æ³•äºŒï¼šé…ç½®åˆ‡æ¢

åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¼€å…³ï¼š

```python
# config.py
USE_LOCAL_MODEL = True  # True: ä½¿ç”¨æœ¬åœ°æ¨¡å‹, False: ä½¿ç”¨äº‘ç«¯æ¨¡å‹
LOCAL_MODEL_PATH = "yolov8m.pt"

# åœ¨ä¸»ç¨‹åºä¸­
if USE_LOCAL_MODEL:
    from src.local_yolo_image_service import LocalYOLOImageAnalysisService
    service = LocalYOLOImageAnalysisService(model_path=LOCAL_MODEL_PATH)
else:
    from src.vision_ai_image_service import VisionAIImageAnalysisService
    service = VisionAIImageAnalysisService()
```

### æ–¹æ³•ä¸‰ï¼šå®Œæ•´ç¤ºä¾‹

```python
import asyncio
import cv2
from src.local_yolo_image_service import LocalYOLOImageAnalysisService

async def analyze_pine_disease(image_path: str):
    """åˆ†ææ¾æçº¿è™«ç—…å›¾åƒ"""
    
    # 1. åˆå§‹åŒ–æœåŠ¡
    service = LocalYOLOImageAnalysisService(
        model_path="yolov8m.pt"  # å¯ä»¥æ¢æˆè‡ªå®šä¹‰è®­ç»ƒçš„æ¨¡å‹
    )
    
    # 2. è¯»å–å›¾åƒ
    image = cv2.imread(image_path)
    if image is None:
        print(f"æ— æ³•è¯»å–å›¾åƒ: {image_path}")
        return
    
    # 3. è¿›è¡Œåˆ†æ
    print(f"æ­£åœ¨åˆ†æå›¾åƒ: {image_path}")
    results = await service._ai_recognize_image_content(image)
    
    # 4. è¾“å‡ºç»“æœ
    print(f"\nè¯†åˆ«ç»“æœ (å…± {len(results)} ä¸ªå¯¹è±¡):")
    print("-" * 80)
    
    for i, obj in enumerate(results, 1):
        print(f"{i}. {obj['name']}")
        print(f"   ç½®ä¿¡åº¦: {obj['confidence']:.2%}")
        print(f"   ç±»åˆ«: {obj['category']}")
        print(f"   æè¿°: {obj['description']}")
        print(f"   ä½ç½®: {obj['location']}")
        if 'bbox' in obj:
            bbox = obj['bbox']
            print(f"   è¾¹ç•Œæ¡†: ({bbox['x1']:.0f}, {bbox['y1']:.0f}) -> "
                  f"({bbox['x2']:.0f}, {bbox['y2']:.0f})")
        print()
    
    # 5. å¯è§†åŒ–ç»“æœï¼ˆå¯é€‰ï¼‰
    visualize_results(image, results, image_path)

def visualize_results(image, results, output_path: str):
    """åœ¨å›¾åƒä¸Šç»˜åˆ¶è¯†åˆ«ç»“æœ"""
    import cv2
    
    vis_image = image.copy()
    
    for obj in results:
        if 'bbox' in obj:
            bbox = obj['bbox']
            x1, y1 = int(bbox['x1']), int(bbox['y1'])
            x2, y2 = int(bbox['x2']), int(bbox['y2'])
            
            # ç»˜åˆ¶è¾¹ç•Œæ¡†
            cv2.rectangle(vis_image, (x1, y1), (x2, y2), (0, 255, 0), 2)
            
            # ç»˜åˆ¶æ ‡ç­¾
            label = f"{obj['name']} {obj['confidence']:.2f}"
            cv2.putText(vis_image, label, (x1, y1 - 10),
                       cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)
    
    # ä¿å­˜å¯è§†åŒ–ç»“æœ
    output = output_path.replace('.jpg', '_result.jpg')
    cv2.imwrite(output, vis_image)
    print(f"å¯è§†åŒ–ç»“æœå·²ä¿å­˜: {output}")

# è¿è¡Œç¤ºä¾‹
if __name__ == "__main__":
    asyncio.run(analyze_pine_disease("test_image.jpg"))
```

---

## ğŸ“ è‡ªå®šä¹‰æ¨¡å‹è®­ç»ƒ

å¦‚æœ YOLOv8 çš„é€šç”¨æ¨¡å‹æ— æ³•æ»¡è¶³éœ€æ±‚ï¼ˆå¦‚è¯†åˆ«æ¾å¢¨å¤©ç‰›ã€æ¾æçº¿è™«ç—…ç—‡çŠ¶ç­‰ï¼‰ï¼Œå¯ä»¥è®­ç»ƒä¸“é—¨çš„æ¨¡å‹ã€‚

### 1. å‡†å¤‡æ•°æ®é›†

#### æ•°æ®é›†ç»“æ„

```
pine_disease_dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ img001.jpg
â”‚   â”‚   â”œâ”€â”€ img002.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ val/
â”‚       â”œâ”€â”€ img101.jpg
â”‚       â””â”€â”€ ...
â”œâ”€â”€ labels/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ img001.txt
â”‚   â”‚   â”œâ”€â”€ img002.txt
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ val/
â”‚       â”œâ”€â”€ img101.txt
â”‚       â””â”€â”€ ...
â””â”€â”€ data.yaml
```

#### æ ‡æ³¨æ–‡ä»¶æ ¼å¼ (YOLO æ ¼å¼)

æ¯ä¸ªå›¾åƒå¯¹åº”ä¸€ä¸ª `.txt` æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºï¼š

```
class_id center_x center_y width height
```

ä¾‹å¦‚ `img001.txt`:
```
0 0.45 0.52 0.12 0.18
1 0.78 0.34 0.08 0.10
```

åæ ‡éƒ½æ˜¯å½’ä¸€åŒ–çš„ (0-1)ã€‚

#### æ•°æ®é…ç½®æ–‡ä»¶ `data.yaml`

```yaml
# æ•°æ®é›†è·¯å¾„
path: D:/datasets/pine_disease_dataset  # æ ¹ç›®å½•
train: images/train  # è®­ç»ƒé›†è·¯å¾„ï¼ˆç›¸å¯¹äº pathï¼‰
val: images/val      # éªŒè¯é›†è·¯å¾„

# ç±»åˆ«
names:
  0: pine_beetle      # æ¾å¢¨å¤©ç‰›
  1: ladybug          # ç“¢è™«
  2: pine_tree        # æ¾æ ‘
  3: diseased_needle  # ç—…å˜æ¾é’ˆ
  4: healthy_needle   # å¥åº·æ¾é’ˆ
  5: resin_flow       # æµè„‚ç°è±¡

# ç±»åˆ«æ•°é‡
nc: 6
```

### 2. ä½¿ç”¨æ ‡æ³¨å·¥å…·

#### æ¨èå·¥å…·

1. **LabelImg** (ç®€å•æ˜“ç”¨)
   ```powershell
   pip install labelImg
   labelImg
   ```

2. **Label Studio** (åŠŸèƒ½å¼ºå¤§)
   ```powershell
   pip install label-studio
   label-studio start
   ```

3. **CVAT** (åœ¨çº¿æ ‡æ³¨å¹³å°)
   è®¿é—® https://www.cvat.ai/

### 3. è®­ç»ƒæ¨¡å‹

```python
from ultralytics import YOLO

# åŠ è½½é¢„è®­ç»ƒæ¨¡å‹
model = YOLO('yolov8m.pt')

# å¼€å§‹è®­ç»ƒ
results = model.train(
    data='pine_disease_dataset/data.yaml',  # æ•°æ®é…ç½®æ–‡ä»¶
    epochs=100,                              # è®­ç»ƒè½®æ•°
    imgsz=640,                              # å›¾åƒå¤§å°
    batch=16,                               # æ‰¹æ¬¡å¤§å°ï¼ˆæ ¹æ®æ˜¾å­˜è°ƒæ•´ï¼‰
    name='pine_disease_detector',          # é¡¹ç›®åç§°
    patience=50,                            # æ—©åœè€å¿ƒå€¼
    save=True,                              # ä¿å­˜æ£€æŸ¥ç‚¹
    device=0,                               # GPU è®¾å¤‡ (0, 1, 2, ... æˆ– 'cpu')
    workers=8,                              # æ•°æ®åŠ è½½çº¿ç¨‹
    pretrained=True,                        # ä½¿ç”¨é¢„è®­ç»ƒæƒé‡
    optimizer='Adam',                       # ä¼˜åŒ–å™¨
    lr0=0.01,                              # åˆå§‹å­¦ä¹ ç‡
    lrf=0.01,                              # æœ€ç»ˆå­¦ä¹ ç‡
    momentum=0.937,                         # SGD åŠ¨é‡
    weight_decay=0.0005,                    # æƒé‡è¡°å‡
    warmup_epochs=3.0,                      # é¢„çƒ­è½®æ•°
    warmup_momentum=0.8,                    # é¢„çƒ­åŠ¨é‡
    box=7.5,                               # è¾¹ç•Œæ¡†æŸå¤±æƒé‡
    cls=0.5,                               # åˆ†ç±»æŸå¤±æƒé‡
    dfl=1.5,                               # DFL æŸå¤±æƒé‡
    plots=True,                            # ä¿å­˜è®­ç»ƒå›¾è¡¨
    verbose=True                            # è¯¦ç»†è¾“å‡º
)

print(f"è®­ç»ƒå®Œæˆ! æœ€ä½³æ¨¡å‹: {results.save_dir}/weights/best.pt")
```

### 4. è¯„ä¼°æ¨¡å‹

```python
from ultralytics import YOLO

# åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
model = YOLO('runs/detect/pine_disease_detector/weights/best.pt')

# åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°
metrics = model.val()

print(f"mAP50: {metrics.box.map50:.3f}")
print(f"mAP50-95: {metrics.box.map:.3f}")
```

### 5. ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹

```python
from src.local_yolo_image_service import LocalYOLOImageAnalysisService

# ä½¿ç”¨è‡ªå®šä¹‰è®­ç»ƒçš„æ¨¡å‹
service = LocalYOLOImageAnalysisService(
    model_path='runs/detect/pine_disease_detector/weights/best.pt',
    use_custom_model=True
)
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. GPU åŠ é€Ÿ

ç¡®ä¿å®‰è£…äº† CUDA ç‰ˆæœ¬çš„ PyTorch:

```python
import torch
print(f"CUDA å¯ç”¨: {torch.cuda.is_available()}")
print(f"PyTorch ç‰ˆæœ¬: {torch.__version__}")
```

### 2. æ‰¹é‡å¤„ç†

```python
from ultralytics import YOLO
import cv2

model = YOLO('yolov8m.pt')

# æ‰¹é‡å¤„ç†å¤šå¼ å›¾ç‰‡
image_paths = ['img1.jpg', 'img2.jpg', 'img3.jpg']
images = [cv2.imread(p) for p in image_paths]

# æ‰¹é‡æ¨ç†ï¼ˆæ›´å¿«ï¼‰
results = model(images, batch=len(images))
```

### 3. æ¨¡å‹é‡åŒ–

```python
from ultralytics import YOLO

model = YOLO('yolov8m.pt')

# å¯¼å‡ºä¸º TensorRT æ ¼å¼ï¼ˆéœ€è¦ NVIDIA GPUï¼‰
model.export(format='engine')  # ç”Ÿæˆ .engine æ–‡ä»¶

# ä½¿ç”¨é‡åŒ–æ¨¡å‹
model_quantized = YOLO('yolov8m.engine')
```

### 4. æ¨ç†å‚æ•°ä¼˜åŒ–

```python
# è°ƒæ•´æ¨ç†å‚æ•°ä»¥æé«˜é€Ÿåº¦
results = model(
    image,
    conf=0.25,      # ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆæé«˜å¯å‡å°‘è¯¯æ£€ï¼‰
    iou=0.45,       # NMS IOU é˜ˆå€¼
    max_det=100,    # æœ€å¤§æ£€æµ‹æ•°é‡
    half=True,      # ä½¿ç”¨ FP16 æ¨ç†ï¼ˆGPUï¼‰
    device=0        # æŒ‡å®š GPU
)
```

### 5. æ€§èƒ½åŸºå‡†æµ‹è¯•

```python
import time
from ultralytics import YOLO
import cv2

model = YOLO('yolov8m.pt')
image = cv2.imread('test.jpg')

# é¢„çƒ­
for _ in range(10):
    model(image)

# æµ‹è¯•
times = []
for _ in range(100):
    start = time.time()
    model(image)
    times.append(time.time() - start)

print(f"å¹³å‡æ¨ç†æ—¶é—´: {sum(times)/len(times)*1000:.2f} ms")
print(f"FPS: {1/(sum(times)/len(times)):.1f}")
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ¨¡å‹ä¸‹è½½å¤±è´¥

**é—®é¢˜**: é¦–æ¬¡è¿è¡Œæ—¶ï¼ŒYOLO æ¨¡å‹ä¸‹è½½å¤±è´¥æˆ–é€Ÿåº¦å¾ˆæ…¢ã€‚

**è§£å†³æ–¹æ³•**:

1. **æ‰‹åŠ¨ä¸‹è½½**:
   - è®¿é—® https://github.com/ultralytics/assets/releases
   - ä¸‹è½½å¯¹åº”çš„ `.pt` æ–‡ä»¶ï¼ˆå¦‚ `yolov8m.pt`ï¼‰
   - æ”¾åˆ°é¡¹ç›®ç›®å½•æˆ– `~/.cache/ultralytics/` ç›®å½•

2. **ä½¿ç”¨å›½å†…é•œåƒ**:
   ```python
   import os
   os.environ['YOLO_VERBOSE'] = 'True'
   # è®¾ç½®ä»£ç†
   os.environ['HTTP_PROXY'] = 'http://your-proxy:port'
   ```

### Q2: CUDA out of memory

**é—®é¢˜**: GPU å†…å­˜ä¸è¶³ã€‚

**è§£å†³æ–¹æ³•**:

1. ä½¿ç”¨æ›´å°çš„æ¨¡å‹ (`yolov8n.pt` æˆ– `yolov8s.pt`)
2. å‡å°æ‰¹æ¬¡å¤§å°
3. ä½¿ç”¨ CPU æ¨ç†:
   ```python
   model = YOLO('yolov8m.pt')
   results = model(image, device='cpu')
   ```

### Q3: è¯†åˆ«å‡†ç¡®ç‡ä½

**é—®é¢˜**: é€šç”¨æ¨¡å‹å¯¹ç‰¹å®šé¢†åŸŸï¼ˆæ¾æçº¿è™«ç—…ï¼‰è¯†åˆ«æ•ˆæœä¸ä½³ã€‚

**è§£å†³æ–¹æ³•**:

1. **æ”¶é›†ä¸“é—¨æ•°æ®é›†å¹¶è®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹**ï¼ˆæ¨èï¼‰
2. è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼:
   ```python
   results = model(image, conf=0.3)  # é™ä½é˜ˆå€¼
   ```
3. ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹ (`yolov8x.pt`)

### Q4: å®‰è£… PyTorch CUDA ç‰ˆæœ¬é—®é¢˜

**é—®é¢˜**: ä¸çŸ¥é“è¯¥å®‰è£…å“ªä¸ª CUDA ç‰ˆæœ¬ã€‚

**è§£å†³æ–¹æ³•**:

1. æŸ¥çœ‹ä½ çš„ CUDA ç‰ˆæœ¬:
   ```powershell
   nvidia-smi
   ```
   
2. æ ¹æ® CUDA ç‰ˆæœ¬é€‰æ‹©:
   - CUDA 11.8: `--index-url https://download.pytorch.org/whl/cu118`
   - CUDA 12.1: `--index-url https://download.pytorch.org/whl/cu121`
   
3. å¦‚æœæ²¡æœ‰ GPUï¼Œä½¿ç”¨ CPU ç‰ˆæœ¬:
   ```powershell
   pip install torch torchvision
   ```

### Q5: æ¨¡å‹æ¨ç†é€Ÿåº¦æ…¢

**è§£å†³æ–¹æ³•**:

1. ä½¿ç”¨æ›´å°çš„æ¨¡å‹ (`yolov8n.pt`)
2. å¯ç”¨ GPU åŠ é€Ÿ
3. ä½¿ç”¨ FP16 æ¨ç†:
   ```python
   results = model(image, half=True)
   ```
4. å¯¼å‡ºä¸º ONNX æˆ– TensorRT æ ¼å¼

### Q6: ä¸åŸæœ‰ä»£ç é›†æˆ

**é—®é¢˜**: å¦‚ä½•åœ¨ä¸ä¿®æ”¹å¤ªå¤šä»£ç çš„æƒ…å†µä¸‹åˆ‡æ¢åˆ°æœ¬åœ°æ¨¡å‹ï¼Ÿ

**è§£å†³æ–¹æ³•**:

åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ç±»:

```python
# adapter.py
from src.vision_ai_image_service import VisionAIImageAnalysisService
from src.local_yolo_image_service import LocalYOLOImageAnalysisService

class ImageAnalysisServiceAdapter:
    def __init__(self, use_local=True):
        if use_local:
            self.service = LocalYOLOImageAnalysisService()
        else:
            self.service = VisionAIImageAnalysisService()
    
    async def analyze(self, image):
        return await self.service._ai_recognize_image_content(image)

# ä½¿ç”¨
service = ImageAnalysisServiceAdapter(use_local=True)
```

---

## ğŸ“Š æ¨¡å‹å¯¹æ¯”

| ç‰¹æ€§         | Moonshot Vision (äº‘ç«¯) | YOLOv8 (æœ¬åœ°)            |
| ------------ | ---------------------- | ------------------------ |
| **éƒ¨ç½²æ–¹å¼** | äº‘ç«¯ API               | æœ¬åœ°éƒ¨ç½²                 |
| **æˆæœ¬**     | æŒ‰è°ƒç”¨æ¬¡æ•°æ”¶è´¹         | ä¸€æ¬¡æ€§æˆæœ¬               |
| **é€Ÿåº¦**     | å—ç½‘ç»œå½±å“             | æ¯«ç§’çº§å“åº”               |
| **éšç§**     | æ•°æ®ä¸Šä¼ åˆ°äº‘ç«¯         | æ•°æ®å®Œå…¨æœ¬åœ°             |
| **å¯å®šåˆ¶æ€§** | å›ºå®šåŠŸèƒ½               | å¯è®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹         |
| **ç¦»çº¿ä½¿ç”¨** | âŒ                      | âœ…                        |
| **å‡†ç¡®ç‡**   | é€šç”¨åœºæ™¯é«˜             | é€šç”¨ä¸­ç­‰ï¼Œè‡ªè®­ç»ƒåå¯è¶…è¶Š |

---

## ğŸ”„ è¿ç§»æ¸…å•

ä» Moonshot Vision è¿ç§»åˆ°æœ¬åœ°æ¨¡å‹:

- [ ] å®‰è£… PyTorch å’Œ Ultralytics
- [ ] ä¸‹è½½/è®­ç»ƒ YOLO æ¨¡å‹
- [ ] åˆ›å»º `LocalYOLOImageAnalysisService` å®ä¾‹
- [ ] æ›¿æ¢åŸæœ‰çš„ `VisionAIImageAnalysisService`
- [ ] æµ‹è¯•è¯†åˆ«æ•ˆæœ
- [ ] å¦‚éœ€è¦ï¼Œå‡†å¤‡æ•°æ®é›†è®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆGPUã€æ‰¹å¤„ç†ç­‰ï¼‰
- [ ] æ›´æ–°éƒ¨ç½²æ–‡æ¡£

---

## ğŸ“š æ›´å¤šèµ„æº

- [YOLOv8 å®˜æ–¹æ–‡æ¡£](https://docs.ultralytics.com/)
- [PyTorch å®˜æ–¹æ–‡æ¡£](https://pytorch.org/docs/)
- [YOLO è®­ç»ƒæ•™ç¨‹](https://docs.ultralytics.com/modes/train/)
- [è‡ªå®šä¹‰æ•°æ®é›†æ•™ç¨‹](https://docs.ultralytics.com/datasets/)
- [æ¨¡å‹å¯¼å‡ºæŒ‡å—](https://docs.ultralytics.com/modes/export/)

---

## ğŸ’¡ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜:

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„[å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)éƒ¨åˆ†
2. æ£€æŸ¥ [YOLOv8 GitHub Issues](https://github.com/ultralytics/ultralytics/issues)
3. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

---

**æœ€åæ›´æ–°**: 2025-12-14
